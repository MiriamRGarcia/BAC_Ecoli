% $Header: svn://.../trunk/AMIGO2R2016/Examples/Arabidopsis_circadian/odes_circadian.m 770 2013-08-06 09:41:45Z attila $
	function ydot= Acircadian_odes(t,y,flag,par,v,pend,tlast) 
	CL_m=y(1);
	CL_c=y(2);
	CL_n=y(3);
	CT_m=y(4);
	CT_c=y(5);
	CT_n=y(6);
	CP_n=y(7);
	n1=par(1);
	n2=par(2);
	g1=par(3);
	g2=par(4);
	m1=par(5);
	m2=par(6);
	m3=par(7);
	m4=par(8);
	m5=par(9);
	m6=par(10);
	m7=par(11);
	k1=par(12);
	k2=par(13);
	k3=par(14);
	k4=par(15);
	k5=par(16);
	k6=par(17);
	k7=par(18);
	p1=par(19);
	p2=par(20);
	p3=par(21);
	r1=par(22);
	r2=par(23);
	r3=par(24);
	r4=par(25);
	q1=par(26);
	q2=par(27);
	u(1)=v(1)+(t-tlast)*pend(1);
	light=u(1);
	dCL_m=q1*CP_n*light+n1*CT_n/(g1+CT_n)-m1*CL_m/(k1+CL_m);
	dCL_c=p1*CL_m-r1*CL_c+r2*CL_n-m2*CL_c/(k2+CL_c)        ;
	dCL_n=r1*CL_c-r2*CL_n-m3*CL_n/(k3+CL_n)                ;
	dCT_m=n2*g2^2/(g2^2+CL_n^2)-m4*CT_m/(k4+CT_m)       ;
	dCT_c=p2*CT_m-r3*CT_c+r4*CT_n-m5*CT_c/(k5+CT_c)        ;
	dCT_n=r3*CT_c-r4*CT_n-m6*CT_n/(k6+CT_n)                ;
	dCP_n=(1-light)*p3-m7*CP_n/(k7+CP_n)-q2*light*CP_n     ;
	ydot(1,1)=dCL_m;
	ydot(2,1)=dCL_c;
	ydot(3,1)=dCL_n;
	ydot(4,1)=dCT_m;
	ydot(5,1)=dCT_c;
	ydot(6,1)=dCT_n;
	ydot(7,1)=dCP_n;
	return
