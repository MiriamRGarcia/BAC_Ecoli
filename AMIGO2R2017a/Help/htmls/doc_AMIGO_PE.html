
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>AMIGO_PE -- Parameter estimation of model unknowns</title><meta name="generator" content="MATLAB 7.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-09-28"><meta name="DC.source" content="doc_AMIGO_PE.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #007946; 
  font-size: large;
}

h1b {
  color: #255DA5; 
  font-size: large;
}

li {
  color: #255DA5; /* bullet color */
}
li {
  color: #255DA5; /* bullet color */
}
li span {
  color: black; /* text color */
}

h2 {
  color: #255DA5;
  font-size: medium;
}
/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 820px;
  /* Hack for IE6 */
  width: auto !important; width: 820px;
  text-align: justify;
}

pre.codeinput {
  background: #E9F4F6;
  padding: 10px;
  width: 820px;
  text-align: justify;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
   width: 820px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h1>AMIGO_PE -- Parameter estimation of model unknowns</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#5">See also</a></li><li><a href="#7">Example</a></li></ul></div><p>AMIGO_PE performs model unknowns estimation. It is inntended to compute model unknowns that minimize the distance among model predictions and experimental data. This distance may be measured in terms of the typical least squares function (lsq) or the log-likelihood function (llk)</p><p>Several types of Gaussian experimental error may be considered within the log-likelihood: homocesdastic and heterocesdastic with constant and non constant variances</p><p>Several local and global optimization methods may be used:</p><div><ul><li>LOCAL optimization methods</li><li>GLOBAL optimization methods</li><li>MULTISTART of local methods</li></ul></div><h2>See also<a name="5"></a></h2><div><ul><li><a href="doc_AMIGO_ivpsol.html">IVP solvers</a></li><li><a href="doc_AMIGO_nlpsol.html">NLP solvers</a></li><li><a href="doc_AMIGO_pecost.html">Cost function</a></li><li><a href="doc_AMIGO_Input.html">how to input a problem in AMIGO</a></li><li><a href="doc_AMIGO_pseudoData.html">how to generate pseudo-experimental data</a></li></ul></div><h2>Example<a name="7"></a></h2><p>
<a name="example"> </a>
</p><pre class="codeinput">clear;
<span class="comment">%============================</span>
<span class="comment">% RESULTS PATHS RELATED DATA</span>
<span class="comment">%============================</span>
inputs.pathd.results_folder=<span class="string">'arabidopsis'</span>;
inputs.pathd.short_name=<span class="string">'arabidopsis'</span>;
inputs.pathd.run_overwrite=<span class="string">'on'</span>;

<span class="comment">% model definition:</span>
inputs.model.n_st=7;
inputs.model.n_par=27;
inputs.model.n_stimulus=1;
inputs.model.st_names=char(<span class="string">'CL_m'</span>,<span class="string">'CL_c'</span>,<span class="string">'CL_n'</span>,<span class="string">'CT_m'</span>,<span class="string">'CT_c'</span>,<span class="string">'CT_n'</span>,<span class="string">'CP_n'</span>);

inputs.model.par_names=char(<span class="string">'n1'</span>,<span class="string">'n2'</span>,<span class="string">'g1'</span>,<span class="string">'g2'</span>,<span class="string">'m1'</span>,<span class="string">'m2'</span>,<span class="string">'m3'</span>,<span class="string">'m4'</span>,<span class="string">'m5'</span>,<span class="string">'m6'</span>,<span class="keyword">...</span>
    <span class="string">'m7'</span>,<span class="string">'k1'</span>,<span class="string">'k2'</span>,<span class="string">'k3'</span>,<span class="string">'k4'</span>,<span class="string">'k5'</span>,<span class="string">'k6'</span>,<span class="string">'k7'</span>,<span class="string">'p1'</span>,<span class="string">'p2'</span>,<span class="keyword">...</span>
    <span class="string">'p3'</span>,<span class="string">'r1'</span>,<span class="string">'r2'</span>,<span class="string">'r3'</span>,<span class="string">'r4'</span>,<span class="string">'q1'</span>,<span class="string">'q2'</span>);

inputs.model.stimulus_names=char(<span class="string">'light'</span>);
inputs.model.eqns=<span class="keyword">...</span>
    char(<span class="string">'dCL_m=q1*CP_n*light+n1*CT_n/(g1+CT_n)-m1*CL_m/(k1+CL_m)'</span>,<span class="keyword">...</span>
    <span class="string">'dCL_c=p1*CL_m-r1*CL_c+r2*CL_n-m2*CL_c/(k2+CL_c)'</span>,<span class="keyword">...</span>
    <span class="string">'dCL_n=r1*CL_c-r2*CL_n-m3*CL_n/(k3+CL_n)'</span>,<span class="keyword">...</span>
    <span class="string">'dCT_m=n2*g2^2/(g2^2+CL_n^2)-m4*CT_m/(k4+CT_m)'</span>,<span class="keyword">...</span>
    <span class="string">'dCT_c=p2*CT_m-r3*CT_c+r4*CT_n-m5*CT_c/(k5+CT_c)'</span>,<span class="keyword">...</span>
    <span class="string">'dCT_n=r3*CT_c-r4*CT_n-m6*CT_n/(k6+CT_n)'</span>,<span class="keyword">...</span>
    <span class="string">'dCP_n=(1-light)*p3-m7*CP_n/(k7+CP_n)-q2*light*CP_n'</span>);
</pre><p>IMPORTANT:</p><p>User may select any customised name but: n, t, u, y, ydot, par, tlast, told, pend and v which are reserved words</p><pre class="codeinput">inputs.model.par=[7.5038 0.6801 1.4992 3.0412 10.0982<span class="keyword">...</span>
    1.9685 3.7511 2.3422 7.2482 1.8981 1.2 3.8045<span class="keyword">...</span>
    5.3087 4.1946 2.5356 1.4420 4.8600 1.2 2.1994<span class="keyword">...</span>
    9.4440 0.5 0.2817 0.7676 0.4364 7.3021 4.5703 1.0];

inputs.exps.n_exp=1;

inputs.exps.t_f{1}=120;

inputs.exps.n_exp=1;

inputs.exps.exp_y0{1}=[0 0 0 0 0 0 0];

inputs.exps.t_con{1}=[0 120];

inputs.exps.u{1}=1;

inputs.exps.u_interp{1}=<span class="string">'sustained'</span>;
inputs.exps.n_exp=2;

<span class="keyword">for</span> iexp=1:inputs.exps.n_exp

    inputs.exps.exp_y0{iexp}=zeros(1,inputs.model.n_st);
    inputs.exps.t_f{iexp}=120;

    <span class="comment">% OBSEVABLES DEFINITION</span>
    inputs.exps.n_obs{iexp}=2;
    inputs.exps.obs_names{iexp}=char(<span class="string">'Lum'</span>,<span class="string">'mRNAa'</span>);
    inputs.exps.obs{iexp}=char(<span class="string">'Lum=CL_m'</span>,<span class="string">'mRNAa=CT_m'</span>);

<span class="keyword">end</span>

inputs.exps.u_interp{1}=<span class="string">'sustained'</span>;

inputs.exps.t_con{1}=[0 120];
inputs.exps.u{1}=1;

inputs.exps.u_interp{2}=<span class="string">'pulse-down'</span>;
inputs.exps.n_pulses{2}=5;
inputs.exps.u_min{2}=0;inputs.exps.u_max{2}=1;
inputs.exps.t_con{2}=0:12:120;

inputs.exps.n_s{1}=15;
inputs.exps.n_s{2}=25;

<span class="comment">%==================================</span>
<span class="comment">% EXPERIMENTAL DATA RELATED INFO</span>
<span class="comment">%==================================</span>
inputs.exps.n_s{1}=15;
inputs.exps.n_s{2}=25;

inputs.exps.data_type=<span class="string">'real'</span>;
inputs.exps.noise_type=<span class="string">'homo_var'</span>;

inputs.exps.exp_data{1}=[
    0.037642  0.059832
    1.398618  0.983442
    1.606762  0.433379
    0.265345  0.628819
    1.417288  0.858973
    1.381613  0.496637
    0.504584  0.717923
    1.240249  0.862584
    1.180193  0.634508
    0.775945  0.679648
    1.514514  0.735783
    0.904653  0.593644
    0.753736  0.759013
    1.389312  0.678665
    0.833228  0.574736
    ];

inputs.exps.error_data{1}=[
    0.037642  0.059832
    0.072461  0.013999
    0.002877  0.020809
    0.050324  0.002705
    0.042936  0.017832
    0.044338  0.022538
    0.016335  0.017981
    0.164745  0.035301
    0.010631  0.102381
    0.127745  0.065791
    0.081671  0.049568
    0.126739  0.050306
    0.006308  0.018894
    0.054665  0.066953
    0.082163  0.015295
    ];

inputs.exps.exp_data{2}=[
    0.146016  0.018152
    0.831813  1.002499
    1.874870  0.816779
    1.927580  0.544111
    1.139536  0.354476
    0.876938  0.520424
    0.559600  0.802322
    1.273548  0.939453
    1.696482  0.687495
    1.065496  0.577896
    0.847460  0.524076
    0.517520  0.738095
    1.162232  0.826737
    1.421504  0.779833
    1.340639  0.550493
    0.563822  0.515605
    0.402755  0.714877
    1.029856  0.871118
    1.490741  0.840174
    1.580873  0.692047
    0.696610  0.459481
    0.141546  0.646803
    0.804194  0.925806
    1.622378  0.824711
    1.525194  0.537398
    ];

inputs.exps.error_data{2}=[
    0.146016  0.018152
    0.066547  0.045194
    0.184009  0.101495
    0.047431  0.030858
    0.175280  0.033712
    0.031945  0.048733
    0.107148  0.008715
    0.019847  0.072804
    0.111892  0.001840
    0.104932  0.058752
    0.059721  0.033324
    0.056537  0.000360
    0.051815  0.037473
    0.103393  0.028094
    0.008084  0.012024
    0.188444  0.022982
    0.046354  0.031981
    0.043436  0.003749
    0.030177  0.042560
    0.116245  0.110535
    0.059345  0.025112
    0.218587  0.000564
    0.115783  0.043708
    0.099239  0.002678
    0.010644  0.052990
    ];

inputs.PEsol.id_global_theta=char(<span class="string">'n1'</span>,<span class="string">'n2'</span>,<span class="string">'m1'</span>,<span class="string">'m4'</span>,<span class="string">'m6'</span>,<span class="string">'m7'</span>,<span class="string">'k1'</span>,<span class="string">'k4'</span>,<span class="string">'p3'</span>);

inputs.PEsol.global_theta_guess=[<span class="keyword">...</span>
    6.09794
    0.710144
    8.92735
    2.38504
    2.11024
    1.29912
    4.32079
    2.45277
    0.493076]';

inputs.PEsol.global_theta_max=10.*inputs.PEsol.global_theta_guess;
inputs.PEsol.global_theta_min=0.01.*inputs.PEsol.global_theta_guess;

inputs.PEsol.id_local_theta_y0{1}=char(<span class="string">'CL_c'</span>,<span class="string">'CP_n'</span>);
inputs.PEsol.local_theta_y0_max{1}=[1 1];
inputs.PEsol.local_theta_y0_min{1}=[0 0];
inputs.PEsol.local_theta_y0_guess{1}=[0.5 0.5];

inputs.PEsol.id_local_theta_y0{2}=char(<span class="string">'CL_c'</span>,<span class="string">'CP_n'</span>);
inputs.PEsol.local_theta_y0_max{2}=[1 1];
inputs.PEsol.local_theta_y0_min{2}=[0 0];
inputs.PEsol.local_theta_y0_guess{2}=[0.5 0.5];

<span class="comment">%==================================</span>
<span class="comment">% COST FUNCTION RELATED DATA</span>
<span class="comment">%==================================</span>

inputs.PEsol.PEcost_type=<span class="string">'lsq'</span>;
inputs.PEsol.lsq_type=<span class="string">'Q_I'</span>;


<span class="comment">%==================================</span>
<span class="comment">% OPTIMIZATION SOLVER RELATED DATA</span>
<span class="comment">%==================================</span>
inputs.nlpsol.eSS.maxtime=10;
inputs.nlpsol.eSS.local.iterprint=0;

inputs.model.input_model_type=<span class="string">'charmodelF'</span>;
</pre><p>More information regarding the inputs used in this example can be found <a href="parestex1.html">here</a>.</p><pre class="codeinput">AMIGO_Prep(inputs);
AMIGO_PE(inputs);
</pre><pre class="codeoutput">

*********************************** 
*     AMIGO, Copyright @CSIC      * 
*       AMIGO2_R1 [July 2013]        *
*********************************** 

*Date: 28-Sep-2015

------&gt;Pre processing....this may take a few seconds.


------&gt;Checking inputs....
------&gt; WARNING message

		 AMIGO_check_model: You did not specify inputs.model.exe_type, standard will be assumed



------&gt; WARNING message

		 You have selected a charmodelF model type. But you have not specified a particular ODE solver.
		 To generate dlls (by default) radau5 is used.
		 If you want to use a different solver, please update your input file. 


------&gt; WARNING message

		 You have selected a charmodelF model type. But you have not specified a particular SENS solver.
		 To generate dlls (by default) odessa is used.


------&gt; Generating fortran code ...



------&gt; Mexing files....

In file D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\radau5\cradau5g.f:86 
 
      CALL FCNCRADAU5(NLHS,PL,NRHS,PR,A3,A5,A7,A9,A10,A13,A15,A17, 
                                      1 
In file D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\radau5\cradau5g.f:92 
 
      SUBROUTINE FCNCRADAU5(NLHS,PL,NRHS,PR,A3,A5,A7,A9,A10,A13,A15, 
                                            2 
Warning (155): Inconsistent types (INTEGER(4)/REAL(8)) in actual argument lists at (1) and (2) 
In file D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\odessa\codessag.f:82 
 
      CALL FCNCODESSA(NLHS,PL,NRHS,PR,A3,A4,A12,A13,A15,A18,A20, 
                                      1 
In file D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\odessa\codessag.f:88 
 
      SUBROUTINE FCNCODESSA(NLHS,PL,NRHS,PR,A3,A4,A12,A13,A15,A18,A20, 
                                            2 
Warning (155): Inconsistent types (INTEGER(4)/REAL(8)) in actual argument lists at (1) and (2) 


------&gt;Files generated....


*********************************** 
*     AMIGO, Copyright @CSIC      * 
*       AMIGO2_R1 [July 2013]        *
*********************************** 

*Date: 28-Sep-2015

------&gt;Checking inputs....
------&gt; WARNING message

		 AMIGO_check_model: You did not specify inputs.model.exe_type, standard will be assumed



------&gt; WARNING message

		 You have selected a charmodelF model type. But you have not specified a particular ODE solver.
		 To generate dlls (by default) radau5 is used.
		 If you want to use a different solver, please update your input file. 


------&gt; WARNING message

		 You have selected a charmodelF model type. But you have not specified a particular SENS solver.
		 To generate dlls (by default) odessa is used.


------&gt; WARNING message

		 You have not provided the sampling times.
 		 Equidistant sampling will be assumed for experiment 1
		 Note however that you may modify your input file by adding
		 inputs.exps.t_s{iexp}


------&gt; WARNING message

		 You have not provided the sampling times.
 		 Equidistant sampling will be assumed for experiment 2
		 Note however that you may modify your input file by adding
		 inputs.exps.t_s{iexp}

*************************************************************************


------&gt;IMPORTANT!!: Most of the optimization solvers have their own
                    tunning parameters (options).
                    Defaults have been assigned in the *NLPsolver*_options
                    files. You may need to modify those settings for your
                    particular problem, specially:
                      - maximum number of function evaluations /iterations,
                      - maximum computational time


******************************************************************

  Solving the NLP problem with
		&gt;Summary of selected eSS options: 
ess_options.
	dim_refset:	'auto'
	inter_save:	0
	iterprint:	1
	local:	(1x1 struct)
	log_var:	[]
	maxeval:	200000
	maxtime:	10
	ndiverse:	'auto'

		  default options are used. 


		&gt;Bounds on the unknowns:

		v_guess(1)=6.097940;  v_min(1)=0.060979;  v_max(1)=60.979400;
		v_guess(2)=0.710144;  v_min(2)=0.007101;  v_max(2)=7.101440;
		v_guess(3)=8.927350;  v_min(3)=0.089274;  v_max(3)=89.273500;
		v_guess(4)=2.385040;  v_min(4)=0.023850;  v_max(4)=23.850400;
		v_guess(5)=2.110240;  v_min(5)=0.021102;  v_max(5)=21.102400;
		v_guess(6)=1.299120;  v_min(6)=0.012991;  v_max(6)=12.991200;
		v_guess(7)=4.320790;  v_min(7)=0.043208;  v_max(7)=43.207900;
		v_guess(8)=2.452770;  v_min(8)=0.024528;  v_max(8)=24.527700;
		v_guess(9)=0.493076;  v_min(9)=0.004931;  v_max(9)=4.930760;
		v_guess(10)=0.500000;  v_min(10)=0.000000;  v_max(10)=1.000000;
		v_guess(11)=0.500000;  v_min(11)=0.000000;  v_max(11)=1.000000;
		v_guess(12)=0.500000;  v_min(12)=0.000000;  v_max(12)=1.000000;
		v_guess(13)=0.500000;  v_min(13)=0.000000;  v_max(13)=1.000000;


------------------------------------------------------------------------------ 
 eSS R2010B - Enhanced Scatter Search    
&lt;c&gt; IIM-CSIC, Vigo, Spain -  email: gingproc@iim.csic.es 
------------------------------------------------------------------------------ 

Refset size automatically calculated: 12
Number of diverse solutions automatically calculated: 130


-------------------------------
Initial value problem related active settings
-------------------------------

ivpsolver: radau5
RelTol: 1e-005
AbsTol: 1e-007
mexfile: radau5g_arabidopsis
Initial Pop: NFunEvals: 136  Bestf: 0.489032      CPUTime: 0.920406    Var: 2.96079e+008 
Iteration: 1 NFunEvals: 279  Bestf: 0.489032      CPUTime: 1.731611    Var: 101.035 
Call local solver: FMINSEARCH 
Initial point function value: 0.489032 
Local solution function value: 0.424762 
Number of function evaluations in the local search: 2601 
CPU Time of the local search: 14.739158  seconds 


Final local refinement with: FMINSEARCH 
Initial point function value: 0.424762 
Local solution function value: 0.422669 
Number of function evaluations in the local search: 2601 
CPU Time of the local search: 14.260163  seconds 

Maximum computation time achieved
Best solution value		0.422669
Decision vector
	8.25833
	0.674595
	9.79592
	2.42489
	1.89855
	1.3846
	3.14869
	2.69181
	0.642107
	0.999606
	0.949899
	2.42767e-006
	7.95054e-008
CPU time		30.7634
Number of function evaluations		5483


------&gt; Computing Correlation Matrix for unknowns...

-------------------------------
Local sensitivity problem related active settings
-------------------------------

senssolver: odessa
ivp_RelTol: 1e-005
ivp_AbsTol: 1e-007
sensmex: odessag_arabidopsis


------&gt; Warning message

		 The Fisher Information Matrix is singular 
		 The reduced Fisher Information Matrix is computed. 

The Fisher Information Matrix is nearly singular. 

The Fisher Information Matrix is nearly singular. 


--------------------------------------------------------------------------
		
Experiment 1: 
		inputs.exp_data{1}=[
		0.037642  0.059832
		1.39862  0.983442
		1.60676  0.433379
		0.265345  0.628819
		1.41729  0.858973
		1.38161  0.496637
		0.504584  0.717923
		1.24025  0.862584
		1.18019  0.634508
		0.775945  0.679648
		1.51451  0.735783
		0.904653  0.593644
		0.753736  0.759013
		1.38931  0.678665
		0.833228  0.574736
		];

		
Experiment 2: 
		inputs.exp_data{2}=[
		0.146016  0.018152
		0.831813  1.0025
		1.87487  0.816779
		1.92758  0.544111
		1.13954  0.354476
		0.876938  0.520424
		0.5596  0.802322
		1.27355  0.939453
		1.69648  0.687495
		1.0655  0.577896
		0.84746  0.524076
		0.51752  0.738095
		1.16223  0.826737
		1.4215  0.779833
		1.34064  0.550493
		0.563822  0.515605
		0.402755  0.714877
		1.02986  0.871118
		1.49074  0.840174
		1.58087  0.692047
		0.69661  0.459481
		0.141546  0.646803
		0.804194  0.925806
		1.62238  0.824711
		1.52519  0.537398
		];



---------------------------------------------------------------------------------------------
&gt;&gt;&gt;&gt;    Mean / Maximum value of the residuals in percentage (100*(data-model)/data):

		Experiment 1 : 
		 Observable 1 --&gt;  mean error: 13.150701 %	 max error: 100.000000 %
		 Observable 2 --&gt;  mean error: 12.215476 %	 max error: 100.000000 %

		Experiment 2 : 
		 Observable 1 --&gt;  mean error: 16.170516 %	 max error: 125.661846 %
		 Observable 2 --&gt;  mean error: 9.507460 %	 max error: 100.000000 %

--------------------------------------------------------------------------

--------------------------------------------------------------------
&gt;&gt;&gt;&gt;    Maximum absolute value of the residuals (data-model):

		Experiment 1 : 
		 Observable 1 --&gt;  max residual: 0.188950 max data: 1.606762
		 Observable 2 --&gt;  max residual: 0.107129 max data: 0.983442

		Experiment 2 : 
		 Observable 1 --&gt;  max residual: 0.198938 max data: 1.927580
		 Observable 2 --&gt;  max residual: 0.112511 max data: 1.002499

--------------------------------------------------------------------------	   

&gt;&gt;&gt;&gt; Best objective function: 0.422669 
	   

&gt;&gt;&gt;&gt; Computational cost: 30.763397 s
&gt; 100.00% of successful simulationn
&gt; 100.00% of successful sensitivity calculations


&gt;&gt;&gt; Best values found and the corresponding asymptotic confidence intervals



&gt;&gt;&gt; Estimated global parameters: 

	n1 : 8.2583e+000  +-  1.0100e+001 (     122%); 
	n2 : 6.7460e-001  +-  1.7638e-001 (    26.1%); 
	m1 : 9.7959e+000  +-  1.1736e+001 (     120%); 
	m4 : 2.4249e+000  +-  1.5140e+000 (    62.4%); 
	m6 : 1.8986e+000  +-  2.0391e+000 (     107%); 
	m7 : 1.3846e+000  +-  4.2804e+000 (     309%); 
	k1 : 3.1487e+000  +-  1.7215e+000 (    54.7%); 
	k4 : 2.6918e+000  +-  1.9364e+000 (    71.9%); 
	p3 : 6.4211e-001  +-  2.0134e+000 (     314%); 


&gt;&gt;&gt; Estimated local initial conditions: 

	Experiment 1, CL_c : 9.9961e-001  +-  4.4960e+001 (4.50e+003%); 
	Experiment 1, CP_n : 9.4990e-001  +-  5.5809e-001 (5.88e+001%); 
	Experiment 2, CL_c : 2.4277e-006  +-  2.0930e+001 (8.62e+008%); (active bound) 
	Experiment 2, CP_n : 7.9505e-008  +-  3.4447e-001 (4.33e+008%); (active bound) 


&gt;&gt;&gt; Correlation matrix for the global unknowns:

	 1.000000e+000	 -7.127611e-001	 9.604385e-001	 -5.406665e-001	 -6.019564e-001	 -8.958181e-001	 -3.596978e-001	 -2.652160e-001	 -8.555049e-001
	 -7.127611e-001	 1.000000e+000	 -7.288214e-001	 4.521217e-001	 1.441259e-001	 6.107027e-001	 -1.712358e-002	 3.004789e-002	 5.807593e-001
	 9.604385e-001	 -7.288214e-001	 1.000000e+000	 -7.190751e-001	 -5.451113e-001	 -8.781958e-001	 -9.131557e-002	 -4.561716e-001	 -8.399247e-001
	 -5.406665e-001	 4.521217e-001	 -7.190751e-001	 1.000000e+000	 1.992636e-001	 6.080929e-001	 -4.281643e-001	 9.038555e-001	 5.984857e-001
	 -6.019564e-001	 1.441259e-001	 -5.451113e-001	 1.992636e-001	 1.000000e+000	 5.743790e-001	 3.892668e-001	 1.865349e-001	 5.551323e-001
	 -8.958181e-001	 6.107027e-001	 -8.781958e-001	 6.080929e-001	 5.743790e-001	 1.000000e+000	 2.816462e-001	 3.912897e-001	 9.963358e-001
	 -3.596978e-001	 -1.712358e-002	 -9.131557e-002	 -4.281643e-001	 3.892668e-001	 2.816462e-001	 1.000000e+000	 -4.678521e-001	 2.673411e-001
	 -2.652160e-001	 3.004789e-002	 -4.561716e-001	 9.038555e-001	 1.865349e-001	 3.912897e-001	 -4.678521e-001	 1.000000e+000	 3.951933e-001
	 -8.555049e-001	 5.807593e-001	 -8.399247e-001	 5.984857e-001	 5.551323e-001	 9.963358e-001	 2.673411e-001	 3.951933e-001	 1.000000e+000


&gt;&gt;&gt; Correlation matrix for the experiment 1

	 1.000000e+000	 8.335257e-003	 9.549112e-001	 9.285303e-002	 -9.097759e-001	 5.328765e-001	 -9.050071e-001	 9.117167e-002	 0.000000e+000	 -5.295791e-001	 5.320801e-001
	 8.335257e-003	 1.000000e+000	 -3.485542e-002	 2.306597e-001	 -3.355207e-001	 4.278363e-001	 -1.622711e-001	 -3.391745e-001	 0.000000e+000	 -4.188496e-001	 4.244808e-001
	 9.549112e-001	 -3.485542e-002	 1.000000e+000	 -1.873310e-001	 -8.431175e-001	 5.480343e-001	 -7.412366e-001	 -1.545595e-001	 0.000000e+000	 -5.445422e-001	 5.471829e-001
	 9.285303e-002	 2.306597e-001	 -1.873310e-001	 1.000000e+000	 -2.256614e-001	 -1.031597e-001	 -4.739854e-001	 8.363738e-001	 0.000000e+000	 1.050428e-001	 -1.038692e-001
	 -9.097759e-001	 -3.355207e-001	 -8.431175e-001	 -2.256614e-001	 1.000000e+000	 -5.531688e-001	 8.886445e-001	 -2.722798e-002	 0.000000e+000	 5.465271e-001	 -5.511051e-001
	 5.328765e-001	 4.278363e-001	 5.480343e-001	 -1.031597e-001	 -5.531688e-001	 1.000000e+000	 -4.718033e-001	 -3.310664e-001	 0.000000e+000	 -9.998967e-001	 9.999868e-001
	 -9.050071e-001	 -1.622711e-001	 -7.412366e-001	 -4.739854e-001	 8.886445e-001	 -4.718033e-001	 1.000000e+000	 -3.709237e-001	 0.000000e+000	 4.684903e-001	 -4.709082e-001
	 9.117167e-002	 -3.391745e-001	 -1.545595e-001	 8.363738e-001	 -2.722798e-002	 -3.310664e-001	 -3.709237e-001	 1.000000e+000	 0.000000e+000	 3.278237e-001	 -3.298552e-001
	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000	 0.000000e+000
	 -5.295791e-001	 -4.188496e-001	 -5.445422e-001	 1.050428e-001	 5.465271e-001	 -9.998967e-001	 4.684903e-001	 3.278237e-001	 0.000000e+000	 1.000000e+000	 -9.999566e-001
	 5.320801e-001	 4.244808e-001	 5.471829e-001	 -1.038692e-001	 -5.511051e-001	 9.999868e-001	 -4.709082e-001	 -3.298552e-001	 0.000000e+000	 -9.999566e-001	 1.000000e+000


&gt;&gt;&gt; Correlation matrix for the experiment 2

	 1.000000e+000	 1.514614e-001	 9.771473e-001	 2.773984e-001	 -8.393721e-001	 -8.997891e-001	 -7.593766e-001	 3.007893e-001	 -8.353704e-001	 6.435213e-001	 -6.438522e-001
	 1.514614e-001	 1.000000e+000	 2.732632e-002	 7.221516e-001	 -5.257402e-001	 3.895700e-002	 -5.919430e-001	 3.559022e-001	 1.016703e-001	 7.700831e-001	 -7.701432e-001
	 9.771473e-001	 2.732632e-002	 1.000000e+000	 9.415577e-002	 -7.729468e-001	 -9.181252e-001	 -6.075803e-001	 1.321346e-001	 -8.648865e-001	 5.332976e-001	 -5.335632e-001
	 2.773984e-001	 7.221516e-001	 9.415577e-002	 1.000000e+000	 -5.207837e-001	 2.047951e-002	 -7.598253e-001	 9.024685e-001	 1.075517e-001	 7.386505e-001	 -7.389234e-001
	 -8.393721e-001	 -5.257402e-001	 -7.729468e-001	 -5.207837e-001	 1.000000e+000	 7.026194e-001	 8.268745e-001	 -3.786661e-001	 6.329004e-001	 -8.061588e-001	 8.061513e-001
	 -8.997891e-001	 3.895700e-002	 -9.181252e-001	 2.047951e-002	 7.026194e-001	 1.000000e+000	 5.625131e-001	 -1.404938e-002	 9.913311e-001	 -4.357714e-001	 4.356490e-001
	 -7.593766e-001	 -5.919430e-001	 -6.075803e-001	 -7.598253e-001	 8.268745e-001	 5.625131e-001	 1.000000e+000	 -6.681387e-001	 4.820493e-001	 -8.380442e-001	 8.383709e-001
	 3.007893e-001	 3.559022e-001	 1.321346e-001	 9.024685e-001	 -3.786661e-001	 -1.404938e-002	 -6.681387e-001	 1.000000e+000	 6.611975e-002	 5.321514e-001	 -5.324280e-001
	 -8.353704e-001	 1.016703e-001	 -8.648865e-001	 1.075517e-001	 6.329004e-001	 9.913311e-001	 4.820493e-001	 6.611975e-002	 1.000000e+000	 -3.521980e-001	 3.519082e-001
	 6.435213e-001	 7.700831e-001	 5.332976e-001	 7.386505e-001	 -8.061588e-001	 -4.357714e-001	 -8.380442e-001	 5.321514e-001	 -3.521980e-001	 1.000000e+000	 -9.999786e-001
	 -6.438522e-001	 -7.701432e-001	 -5.335632e-001	 -7.389234e-001	 8.061513e-001	 4.356490e-001	 8.383709e-001	 -5.324280e-001	 3.519082e-001	 -9.999786e-001	 1.000000e+000


------&gt;Plotting results....

</pre><pre class="codeoutput">Error using xticklabel_rotate (line 117)
xticklabel_rotate : must have same number of elements in "XTick" and "XTickLabel"

Error in AMIGO_plot_correlationmat (line 44)
    xticklabel_rotate([],90,[],'interpreter','none');

Error in AMIGO_post_plot_PE (line 77)
            AMIGO_plot_correlationmat

Error in AMIGO_PE (line 324)
        AMIGO_post_plot_PE(inputs,results,privstruct);

Error in doc_AMIGO_PE (line 266)
AMIGO_PE(inputs);
</pre><pre class="codeinput">AMIGO_htmldoc_inputs(inputs,fullfile(pwd,<span class="string">'html'</span>,<span class="string">'parestex1.html'</span>));
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.13<br></p></div><!--
##### SOURCE BEGIN #####
%% AMIGO_PE REPLACE_WITH_DASH_DASH Parameter estimation of model unknowns

    %%                                                                            
    % AMIGO_PE performs model unknowns estimation. It is inntended to compute model unknowns that minimize the distance     
    % among model predictions and experimental data. This distance may  
    % be measured in terms of the typical least squares function (lsq)  
    % or the log-likelihood function (llk)                              
                                                                            
    %%
    % Several types of Gaussian experimental error may be considered   
    % within the log-likelihood: homocesdastic and heterocesdastic      
    % with constant and non constant variances                          
    
    %%
    % Several local and global optimization methods may be used:        
           
        %%
        % * LOCAL optimization methods                                   
        % * GLOBAL optimization methods                                 
        % * MULTISTART of local methods                                  
                                                                            
%% See also

    %%
    % * <doc_AMIGO_ivpsol.html IVP solvers>
    % * <doc_AMIGO_nlpsol.html NLP solvers>
    % * <doc_AMIGO_pecost.html Cost function>
    % * <doc_AMIGO_Input.html how to input a problem in AMIGO>
    % * <doc_AMIGO_pseudoData.html how to generate pseudo-experimental data>


%% Example
%
% <html>
% <a name="example"> </a>
% </html>
% 
clear;    
%============================
% RESULTS PATHS RELATED DATA
%============================
inputs.pathd.results_folder='arabidopsis';
inputs.pathd.short_name='arabidopsis';
inputs.pathd.run_overwrite='on';

% model definition:            
inputs.model.n_st=7;                                     
inputs.model.n_par=27;                                   
inputs.model.n_stimulus=1;                               
inputs.model.st_names=char('CL_m','CL_c','CL_n','CT_m','CT_c','CT_n','CP_n');    

inputs.model.par_names=char('n1','n2','g1','g2','m1','m2','m3','m4','m5','m6',...
    'm7','k1','k2','k3','k4','k5','k6','k7','p1','p2',...
    'p3','r1','r2','r3','r4','q1','q2');             

inputs.model.stimulus_names=char('light');                
inputs.model.eqns=...                                      
    char('dCL_m=q1*CP_n*light+n1*CT_n/(g1+CT_n)-m1*CL_m/(k1+CL_m)',...
    'dCL_c=p1*CL_m-r1*CL_c+r2*CL_n-m2*CL_c/(k2+CL_c)',...
    'dCL_n=r1*CL_c-r2*CL_n-m3*CL_n/(k3+CL_n)',...
    'dCT_m=n2*g2^2/(g2^2+CL_n^2)-m4*CT_m/(k4+CT_m)',...
    'dCT_c=p2*CT_m-r3*CT_c+r4*CT_n-m5*CT_c/(k5+CT_c)',...
    'dCT_n=r3*CT_c-r4*CT_n-m6*CT_n/(k6+CT_n)',...
    'dCP_n=(1-light)*p3-m7*CP_n/(k7+CP_n)-q2*light*CP_n');

    %% 
    % IMPORTANT:
    %
    % User may select any customised name but: n, t, u, y, ydot, par, tlast,
    % told, pend and v which are reserved words
    
inputs.model.par=[7.5038 0.6801 1.4992 3.0412 10.0982...   
    1.9685 3.7511 2.3422 7.2482 1.8981 1.2 3.8045...
    5.3087 4.1946 2.5356 1.4420 4.8600 1.2 2.1994...
    9.4440 0.5 0.2817 0.7676 0.4364 7.3021 4.5703 1.0];  

inputs.exps.n_exp=1; 

inputs.exps.t_f{1}=120;    

inputs.exps.n_exp=1;

inputs.exps.exp_y0{1}=[0 0 0 0 0 0 0];  

inputs.exps.t_con{1}=[0 120];                         

inputs.exps.u{1}=1;  

inputs.exps.u_interp{1}='sustained';
inputs.exps.n_exp=2;                                  

for iexp=1:inputs.exps.n_exp
    
    inputs.exps.exp_y0{iexp}=zeros(1,inputs.model.n_st);  
    inputs.exps.t_f{iexp}=120;                            
   
    % OBSEVABLES DEFINITION
    inputs.exps.n_obs{iexp}=2;                            
    inputs.exps.obs_names{iexp}=char('Lum','mRNAa');      
    inputs.exps.obs{iexp}=char('Lum=CL_m','mRNAa=CT_m');   
    
end

inputs.exps.u_interp{1}='sustained';                  

inputs.exps.t_con{1}=[0 120];                         
inputs.exps.u{1}=1;                                 

inputs.exps.u_interp{2}='pulse-down';                 
inputs.exps.n_pulses{2}=5;                            
inputs.exps.u_min{2}=0;inputs.exps.u_max{2}=1;        
inputs.exps.t_con{2}=0:12:120;                    
 
inputs.exps.n_s{1}=15;
inputs.exps.n_s{2}=25;
    
%==================================
% EXPERIMENTAL DATA RELATED INFO
%==================================
inputs.exps.n_s{1}=15;                                
inputs.exps.n_s{2}=25;                                

inputs.exps.data_type='real';                         
inputs.exps.noise_type='homo_var';                               

inputs.exps.exp_data{1}=[                              
    0.037642  0.059832
    1.398618  0.983442
    1.606762  0.433379
    0.265345  0.628819
    1.417288  0.858973
    1.381613  0.496637
    0.504584  0.717923
    1.240249  0.862584
    1.180193  0.634508
    0.775945  0.679648
    1.514514  0.735783
    0.904653  0.593644
    0.753736  0.759013
    1.389312  0.678665
    0.833228  0.574736
    ];

inputs.exps.error_data{1}=[                            
    0.037642  0.059832
    0.072461  0.013999
    0.002877  0.020809
    0.050324  0.002705
    0.042936  0.017832
    0.044338  0.022538
    0.016335  0.017981
    0.164745  0.035301
    0.010631  0.102381
    0.127745  0.065791
    0.081671  0.049568
    0.126739  0.050306
    0.006308  0.018894
    0.054665  0.066953
    0.082163  0.015295
    ];

inputs.exps.exp_data{2}=[
    0.146016  0.018152
    0.831813  1.002499
    1.874870  0.816779
    1.927580  0.544111
    1.139536  0.354476
    0.876938  0.520424
    0.559600  0.802322
    1.273548  0.939453
    1.696482  0.687495
    1.065496  0.577896
    0.847460  0.524076
    0.517520  0.738095
    1.162232  0.826737
    1.421504  0.779833
    1.340639  0.550493
    0.563822  0.515605
    0.402755  0.714877
    1.029856  0.871118
    1.490741  0.840174
    1.580873  0.692047
    0.696610  0.459481
    0.141546  0.646803
    0.804194  0.925806
    1.622378  0.824711
    1.525194  0.537398
    ];

inputs.exps.error_data{2}=[
    0.146016  0.018152
    0.066547  0.045194
    0.184009  0.101495
    0.047431  0.030858
    0.175280  0.033712
    0.031945  0.048733
    0.107148  0.008715
    0.019847  0.072804
    0.111892  0.001840
    0.104932  0.058752
    0.059721  0.033324
    0.056537  0.000360
    0.051815  0.037473
    0.103393  0.028094
    0.008084  0.012024
    0.188444  0.022982
    0.046354  0.031981
    0.043436  0.003749
    0.030177  0.042560
    0.116245  0.110535
    0.059345  0.025112
    0.218587  0.000564
    0.115783  0.043708
    0.099239  0.002678
    0.010644  0.052990
    ];
    
inputs.PEsol.id_global_theta=char('n1','n2','m1','m4','m6','m7','k1','k4','p3'); 

inputs.PEsol.global_theta_guess=[...
    6.09794
    0.710144
    8.92735
    2.38504
    2.11024
    1.29912
    4.32079
    2.45277
    0.493076]';

inputs.PEsol.global_theta_max=10.*inputs.PEsol.global_theta_guess; 
inputs.PEsol.global_theta_min=0.01.*inputs.PEsol.global_theta_guess;

inputs.PEsol.id_local_theta_y0{1}=char('CL_c','CP_n');   
inputs.PEsol.local_theta_y0_max{1}=[1 1];           
inputs.PEsol.local_theta_y0_min{1}=[0 0];           
inputs.PEsol.local_theta_y0_guess{1}=[0.5 0.5];         

inputs.PEsol.id_local_theta_y0{2}=char('CL_c','CP_n');   
inputs.PEsol.local_theta_y0_max{2}=[1 1];               
inputs.PEsol.local_theta_y0_min{2}=[0 0];              
inputs.PEsol.local_theta_y0_guess{2}=[0.5 0.5];         
                                
%==================================
% COST FUNCTION RELATED DATA
%==================================

inputs.PEsol.PEcost_type='lsq';
inputs.PEsol.lsq_type='Q_I'; 


%==================================
% OPTIMIZATION SOLVER RELATED DATA
%==================================
inputs.nlpsol.eSS.maxtime=10;  
inputs.nlpsol.eSS.local.iterprint=0;

inputs.model.input_model_type='charmodelF';

    %%
    % More information regarding the inputs used in this example can be
    % found <parestex1.html here>. 


AMIGO_Prep(inputs);
AMIGO_PE(inputs);

%%
%

AMIGO_htmldoc_inputs(inputs,fullfile(pwd,'html','parestex1.html'));   
    

##### SOURCE END #####
--></body></html>