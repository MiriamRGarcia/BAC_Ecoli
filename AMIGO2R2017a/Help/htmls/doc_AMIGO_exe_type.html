
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>doc_AMIGO_exe_type</title><meta name="generator" content="MATLAB 7.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-09-28"><meta name="DC.source" content="doc_AMIGO_exe_type.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #007946; 
  font-size: large;
}

h1b {
  color: #255DA5; 
  font-size: large;
}

li {
  color: #255DA5; /* bullet color */
}
li {
  color: #255DA5; /* bullet color */
}
li span {
  color: black; /* text color */
}

h2 {
  color: #255DA5;
  font-size: medium;
}
/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 820px;
  /* Hack for IE6 */
  width: auto !important; width: 820px;
  text-align: justify;
}

pre.codeinput {
  background: #E9F4F6;
  padding: 10px;
  width: 820px;
  text-align: justify;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
   width: 820px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h1></h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Execution modes in AMIGO</a></li><li><a href="#2">See also</a></li><li><a href="#4">Example</a></li><li><a href="#7">Example Standard</a></li><li><a href="#8">Example costMex</a></li><li><a href="#13">Example fullMex</a></li><li><a href="#14">Example fullC</a></li></ul></div><h2>Execution modes in AMIGO<a name="1"></a></h2><h2>See also<a name="2"></a></h2><div><ul><li><a href="doc_AMIGO_costMex.html">costMex</a></li><li><a href="doc_AMIGO_fullMex.html">fullMex</a></li><li><a href="doc_AMIGO_fullC.html">fullC</a></li><li><a href="doc_AMIGO_Input.html">how to input a problem in AMIGO</a></li></ul></div><h2>Example<a name="4"></a></h2><pre class="codeinput">clear;
<span class="comment">%============================</span>
<span class="comment">% RESULTS PATHS RELATED DATA</span>
<span class="comment">%============================</span>
inputs.pathd.results_folder=<span class="string">'arabidopsis'</span>;
inputs.pathd.short_name=<span class="string">'arabidopsis'</span>;
inputs.pathd.run_overwrite=<span class="string">'on'</span>;

<span class="comment">% model definition:</span>
inputs.model.n_st=7;
inputs.model.n_par=27;
inputs.model.n_stimulus=1;
inputs.model.st_names=char(<span class="string">'CL_m'</span>,<span class="string">'CL_c'</span>,<span class="string">'CL_n'</span>,<span class="string">'CT_m'</span>,<span class="string">'CT_c'</span>,<span class="string">'CT_n'</span>,<span class="string">'CP_n'</span>);

inputs.model.par_names=char(<span class="string">'n1'</span>,<span class="string">'n2'</span>,<span class="string">'g1'</span>,<span class="string">'g2'</span>,<span class="string">'m1'</span>,<span class="string">'m2'</span>,<span class="string">'m3'</span>,<span class="string">'m4'</span>,<span class="string">'m5'</span>,<span class="string">'m6'</span>,<span class="keyword">...</span>
    <span class="string">'m7'</span>,<span class="string">'k1'</span>,<span class="string">'k2'</span>,<span class="string">'k3'</span>,<span class="string">'k4'</span>,<span class="string">'k5'</span>,<span class="string">'k6'</span>,<span class="string">'k7'</span>,<span class="string">'p1'</span>,<span class="string">'p2'</span>,<span class="keyword">...</span>
    <span class="string">'p3'</span>,<span class="string">'r1'</span>,<span class="string">'r2'</span>,<span class="string">'r3'</span>,<span class="string">'r4'</span>,<span class="string">'q1'</span>,<span class="string">'q2'</span>);

inputs.model.stimulus_names=char(<span class="string">'light'</span>);
inputs.model.eqns=<span class="keyword">...</span>
    char(<span class="string">'dCL_m=q1*CP_n*light+n1*CT_n/(g1+CT_n)-m1*CL_m/(k1+CL_m)'</span>,<span class="keyword">...</span>
    <span class="string">'dCL_c=p1*CL_m-r1*CL_c+r2*CL_n-m2*CL_c/(k2+CL_c)'</span>,<span class="keyword">...</span>
    <span class="string">'dCL_n=r1*CL_c-r2*CL_n-m3*CL_n/(k3+CL_n)'</span>,<span class="keyword">...</span>
    <span class="string">'dCT_m=n2*g2^2/(g2^2+CL_n^2)-m4*CT_m/(k4+CT_m)'</span>,<span class="keyword">...</span>
    <span class="string">'dCT_c=p2*CT_m-r3*CT_c+r4*CT_n-m5*CT_c/(k5+CT_c)'</span>,<span class="keyword">...</span>
    <span class="string">'dCT_n=r3*CT_c-r4*CT_n-m6*CT_n/(k6+CT_n)'</span>,<span class="keyword">...</span>
    <span class="string">'dCP_n=(1-light)*p3-m7*CP_n/(k7+CP_n)-q2*light*CP_n'</span>);
</pre><p>IMPORTANT:</p><p>User may select any customised name but: n, t, u, y, ydot, par, tlast, told, pend and v which are reserved words</p><pre class="codeinput">inputs.model.par=[7.5038 0.6801 1.4992 3.0412 10.0982<span class="keyword">...</span>
    1.9685 3.7511 2.3422 7.2482 1.8981 1.2 3.8045<span class="keyword">...</span>
    5.3087 4.1946 2.5356 1.4420 4.8600 1.2 2.1994<span class="keyword">...</span>
    9.4440 0.5 0.2817 0.7676 0.4364 7.3021 4.5703 1.0];

inputs.exps.n_exp=2;

<span class="keyword">for</span> iexp=1:inputs.exps.n_exp

    inputs.exps.exp_y0{iexp}=zeros(1,inputs.model.n_st);
    inputs.exps.t_f{iexp}=120;

    <span class="comment">% OBSEVABLES DEFINITION</span>
    inputs.exps.n_obs{iexp}=2;
    inputs.exps.obs_names{iexp}=char(<span class="string">'Lum'</span>,<span class="string">'mRNAa'</span>);
    inputs.exps.obs{iexp}=char(<span class="string">'Lum=CL_m'</span>,<span class="string">'mRNAa=CT_m'</span>);

<span class="keyword">end</span>

inputs.exps.u_interp{1}=<span class="string">'sustained'</span>;
inputs.exps.t_con{1}=[0 120];
inputs.exps.u{1}=1;

inputs.exps.u_interp{2}=<span class="string">'pulse-down'</span>;
inputs.exps.n_pulses{2}=5;
inputs.exps.u_min{2}=0;inputs.exps.u_max{2}=1;
inputs.exps.t_con{2}=0:12:120;

<span class="comment">%==================================</span>
<span class="comment">% EXPERIMENTAL DATA RELATED INFO</span>
<span class="comment">%==================================</span>
inputs.exps.n_s{1}=15;
inputs.exps.n_s{2}=25;

inputs.exps.data_type=<span class="string">'real'</span>;

inputs.exps.exp_data{1}=[
    0.037642  0.059832
    1.398618  0.983442
    1.606762  0.433379
    0.265345  0.628819
    1.417288  0.858973
    1.381613  0.496637
    0.504584  0.717923
    1.240249  0.862584
    1.180193  0.634508
    0.775945  0.679648
    1.514514  0.735783
    0.904653  0.593644
    0.753736  0.759013
    1.389312  0.678665
    0.833228  0.574736
    ];

inputs.exps.error_data{1}=[
    0.037642  0.059832
    0.072461  0.013999
    0.002877  0.020809
    0.050324  0.002705
    0.042936  0.017832
    0.044338  0.022538
    0.016335  0.017981
    0.164745  0.035301
    0.010631  0.102381
    0.127745  0.065791
    0.081671  0.049568
    0.126739  0.050306
    0.006308  0.018894
    0.054665  0.066953
    0.082163  0.015295
    ];

inputs.exps.exp_data{2}=[
    0.146016  0.018152
    0.831813  1.002499
    1.874870  0.816779
    1.927580  0.544111
    1.139536  0.354476
    0.876938  0.520424
    0.559600  0.802322
    1.273548  0.939453
    1.696482  0.687495
    1.065496  0.577896
    0.847460  0.524076
    0.517520  0.738095
    1.162232  0.826737
    1.421504  0.779833
    1.340639  0.550493
    0.563822  0.515605
    0.402755  0.714877
    1.029856  0.871118
    1.490741  0.840174
    1.580873  0.692047
    0.696610  0.459481
    0.141546  0.646803
    0.804194  0.925806
    1.622378  0.824711
    1.525194  0.537398
    ];

inputs.exps.error_data{2}=[
    0.146016  0.018152
    0.066547  0.045194
    0.184009  0.101495
    0.047431  0.030858
    0.175280  0.033712
    0.031945  0.048733
    0.107148  0.008715
    0.019847  0.072804
    0.111892  0.001840
    0.104932  0.058752
    0.059721  0.033324
    0.056537  0.000360
    0.051815  0.037473
    0.103393  0.028094
    0.008084  0.012024
    0.188444  0.022982
    0.046354  0.031981
    0.043436  0.003749
    0.030177  0.042560
    0.116245  0.110535
    0.059345  0.025112
    0.218587  0.000564
    0.115783  0.043708
    0.099239  0.002678
    0.010644  0.052990
    ];

inputs.PEsol.id_global_theta=char(<span class="string">'n1'</span>,<span class="string">'n2'</span>,<span class="string">'m1'</span>,<span class="string">'m4'</span>,<span class="string">'m6'</span>,<span class="string">'m7'</span>,<span class="string">'k1'</span>,<span class="string">'k4'</span>,<span class="string">'p3'</span>);

inputs.PEsol.global_theta_guess=[<span class="keyword">...</span>
    6.09794
    0.710144
    8.92735
    2.38504
    2.11024
    1.29912
    4.32079
    2.45277
    0.493076]';

inputs.PEsol.global_theta_max=10.*inputs.PEsol.global_theta_guess;
inputs.PEsol.global_theta_min=0.01.*inputs.PEsol.global_theta_guess;

inputs.PEsol.id_local_theta_y0{1}=char(<span class="string">'CL_c'</span>,<span class="string">'CP_n'</span>);
inputs.PEsol.local_theta_y0_max{1}=[1 1];
inputs.PEsol.local_theta_y0_min{1}=[0 0];
inputs.PEsol.local_theta_y0_guess{1}=[0.5 0.5];

inputs.PEsol.id_local_theta_y0{2}=char(<span class="string">'CL_c'</span>,<span class="string">'CP_n'</span>);
inputs.PEsol.local_theta_y0_max{2}=[1 1];
inputs.PEsol.local_theta_y0_min{2}=[0 0];
inputs.PEsol.local_theta_y0_guess{2}=[0.5 0.5];

<span class="comment">%==================================</span>
<span class="comment">% COST FUNCTION RELATED DATA</span>
<span class="comment">%==================================</span>

inputs.PEsol.PEcost_type=<span class="string">'lsq'</span>;
inputs.PEsol.lsq_type=<span class="string">'Q_I'</span>;

<span class="comment">%==================================</span>
<span class="comment">% OPTIMIZATION SOLVER RELATED DATA</span>
<span class="comment">%==================================</span>
</pre><p>More information regarding the inputs used in this example can be found <a href="extypeex1.html">here</a>.</p><h2>Example Standard<a name="7"></a></h2><pre class="codeinput">inputs.model.input_model_type=<span class="string">'charmodelC'</span>;
inputs.model.exe_type=<span class="string">'standard'</span>;
AMIGO_Prep(inputs);
</pre><pre class="codeoutput">

*********************************** 
*     AMIGO, Copyright @CSIC      * 
*       AMIGO2_R1 [July 2013]        *
*********************************** 

*Date: 28-Sep-2015

------&gt;Pre processing....this may take a few seconds.


------&gt;Checking inputs....
------&gt; Generating C code ...


------&gt; Mexing files....

D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\cvodes\C_src4Amigo\src\src_amigo\simulate_amigo_model.c: In function 'simulate_amigo_model': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\cvodes\C_src4Amigo\src\src_amigo\simulate_amigo_model.c:330:6: warning: passing argument 1 of 'mexPrintf' from incompatible pointer type [enabled by default] 
      mexPrintf(stderr,"\nSolver failed at flag = CVode(cvode_mem, tout, y, &amp;t, CV_TSTOP_RETURN);. . .\n"); 
      ^ 
In file included from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\cvodes\C_src4Amigo\include\include_amigo/simulate_amigo_model.h:4:0, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\cvodes\C_src4Amigo\src\src_amigo\simulate_amigo_model.c:1: 
C:\MATLAB\R2011B~1\extern\include/mex.h:209:14: note: expected 'const char *' but argument is of type 'struct FILE *' 
 EXTERN_C int mexPrintf( 
              ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\cvodes\C_src4Amigo\src\src_interface\interface_with_matlab.c: In function 'mexFunction': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\IVP_solvers\cvodes\C_src4Amigo\src\src_interface\interface_with_matlab.c:200:17: warning: assignment from incompatible pointer type [enabled by default] 
    stats_struct = mxGetPr(plhs[5]); 
                 ^ 


------&gt;Files generated....
</pre><h2>Example costMex<a name="8"></a></h2><pre class="codeinput">inputs.model.input_model_type=<span class="string">'charmodelC'</span>;
inputs.model.exe_type=<span class="string">'costMex'</span>;
[inputs privstruct]=AMIGO_Prep(inputs);
</pre><pre class="codeoutput">

*********************************** 
*     AMIGO, Copyright @CSIC      * 
*       AMIGO2_R1 [July 2013]        *
*********************************** 

*Date: 28-Sep-2015

------&gt;Pre processing....this may take a few seconds.


------&gt;Checking inputs....


------&gt; WARNING message

		 You have not provided the sampling times.
 		 Equidistant sampling will be assumed for experiment 1
		 Note however that you may modify your input file by adding
		 inputs.exps.t_s{iexp}


------&gt; WARNING message

		 You have not provided the sampling times.
 		 Equidistant sampling will be assumed for experiment 2
		 Note however that you may modify your input file by adding
		 inputs.exps.t_s{iexp}
------&gt; Generating C code ...
In file included from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_types.h:50:0, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_direct.h:26, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_direct.h:31, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_dense.h:24, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/AMIGO_model.h:6, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/amigoRHS.h:1, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:1: 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:65:0: warning: "SUNDIALS_BLAS_LAPACK" redefined [enabled by default] 
  #define SUNDIALS_BLAS_LAPACK 1 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:63:0: note: this is the location of the previous definition 
 #define SUNDIALS_BLAS_LAPACK 0 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:98:0: warning: "CL_m" redefined [enabled by default] 
 #define  CL_m (amigo_model-&gt;sim_results[0][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:12:0: note: this is the location of the previous definition 
 #define CL_m Ith(y,0) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:99:0: warning: "CL_c" redefined [enabled by default] 
 #define  CL_c (amigo_model-&gt;sim_results[1][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:13:0: note: this is the location of the previous definition 
 #define CL_c Ith(y,1) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:100:0: warning: "CL_n" redefined [enabled by default] 
 #define  CL_n (amigo_model-&gt;sim_results[2][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:14:0: note: this is the location of the previous definition 
 #define CL_n Ith(y,2) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:101:0: warning: "CT_m" redefined [enabled by default] 
 #define  CT_m (amigo_model-&gt;sim_results[3][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:15:0: note: this is the location of the previous definition 
 #define CT_m Ith(y,3) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:102:0: warning: "CT_c" redefined [enabled by default] 
 #define  CT_c (amigo_model-&gt;sim_results[4][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:16:0: note: this is the location of the previous definition 
 #define CT_c Ith(y,4) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:103:0: warning: "CT_n" redefined [enabled by default] 
 #define  CT_n (amigo_model-&gt;sim_results[5][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:17:0: note: this is the location of the previous definition 
 #define CT_n Ith(y,5) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:104:0: warning: "CP_n" redefined [enabled by default] 
 #define  CP_n (amigo_model-&gt;sim_results[6][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:18:0: note: this is the location of the previous definition 
 #define CP_n Ith(y,6) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c: In function 'amigoRHS_get_OBS': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:146:2: warning: 'return' with a value, in function returning void [enabled by default] 
  return(amigo_model); 
  ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c: At top level: 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:150:0: warning: "CL_m" redefined [enabled by default] 
 #define  CL_m (amigo_model-&gt;sens_results[0][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:98:0: note: this is the location of the previous definition 
 #define  CL_m (amigo_model-&gt;sim_results[0][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:151:0: warning: "CL_c" redefined [enabled by default] 
 #define  CL_c (amigo_model-&gt;sens_results[1][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:99:0: note: this is the location of the previous definition 
 #define  CL_c (amigo_model-&gt;sim_results[1][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:152:0: warning: "CL_n" redefined [enabled by default] 
 #define  CL_n (amigo_model-&gt;sens_results[2][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:100:0: note: this is the location of the previous definition 
 #define  CL_n (amigo_model-&gt;sim_results[2][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:153:0: warning: "CT_m" redefined [enabled by default] 
 #define  CT_m (amigo_model-&gt;sens_results[3][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:101:0: note: this is the location of the previous definition 
 #define  CT_m (amigo_model-&gt;sim_results[3][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:154:0: warning: "CT_c" redefined [enabled by default] 
 #define  CT_c (amigo_model-&gt;sens_results[4][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:102:0: note: this is the location of the previous definition 
 #define  CT_c (amigo_model-&gt;sim_results[4][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:155:0: warning: "CT_n" redefined [enabled by default] 
 #define  CT_n (amigo_model-&gt;sens_results[5][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:103:0: note: this is the location of the previous definition 
 #define  CT_n (amigo_model-&gt;sim_results[5][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:156:0: warning: "CP_n" redefined [enabled by default] 
 #define  CP_n (amigo_model-&gt;sens_results[6][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:104:0: note: this is the location of the previous definition 
 #define  CP_n (amigo_model-&gt;sim_results[6][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c: In function 'amigoRHS_get_sens_OBS': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:171:0: warning: "Lum" redefined [enabled by default] 
   #define  Lum   amigo_model-&gt;sens_obs[0][j][k]  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:130:0: note: this is the location of the previous definition 
   #define  Lum   amigo_model-&gt;obs_results[0][j]  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:172:0: warning: "mRNAa" redefined [enabled by default] 
   #define  mRNAa amigo_model-&gt;sens_obs[1][j][k]  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:131:0: note: this is the location of the previous definition 
   #define  mRNAa amigo_model-&gt;obs_results[1][j]  
 ^ 
In file included from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_types.h:50:0, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_direct.h:26, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_direct.h:31, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_dense.h:24, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/AMIGO_model.h:6, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/amigoRHS.h:1, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c:2: 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:65:0: warning: "SUNDIALS_BLAS_LAPACK" redefined [enabled by default] 
  #define SUNDIALS_BLAS_LAPACK 1 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:63:0: note: this is the location of the previous definition 
 #define SUNDIALS_BLAS_LAPACK 0 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c: In function 'mexFunction': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c:21:2: warning: passing argument 8 of 'run_mexFunction' from incompatible pointer type [enabled by default] 
  run_mexFunction(nlhs, plhs, nrhs,prhs, amigoRHS,amigoRHS_get_OBS,amigoRHS_get_sens_OBS,amigo_Y_at_tcon); 
  ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c:6:16: note: expected 'void (*)(struct AMIGO_model,  realtype,  struct _generic_N_Vector *)' but argument is of type 'void (*)(void *, realtype,  struct _generic_N_Vector *)' 
  EXPORTIT void run_mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[],int(*rhs)(realtype,N_Vector, N_Vector, void*),void(obs_func)(void*),void(obs_sens_func)(void*),void(change_y_func)(AMIGO_model,realtype,N_Vector)); 
                ^ 


------&gt;Files generated....
</pre><p>You can use the mexfile to evaluate the objetive function value.</p><pre class="codeinput">feval(inputs.model.mexfunction,<span class="string">'cost_LSQ'</span>);
fprintf(1,<span class="string">'Objective function value=%e\n'</span>,outputs.f);
</pre><pre class="codeoutput">Objective function value=4.490598e-001
</pre><p>The mexfile is located in:</p><pre class="codeinput">disp(inputs.model.mexfile);
</pre><pre class="codeoutput">D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\costMex_arabidopsis
</pre><p>We can also compute the trajectories</p><pre class="codeinput">feval(inputs.model.mexfunction,<span class="string">'sim_CVODES'</span>);
</pre><p>We can also compute sensitivities</p><pre class="codeinput">feval(inputs.model.mexfunction,<span class="string">'sens_FSA_CVODES'</span>);
</pre><h2>Example fullMex<a name="13"></a></h2><pre class="codeinput">inputs.model.input_model_type=<span class="string">'charmodelC'</span>;
inputs.model.exe_type=<span class="string">'fullMex'</span>;
inputs.nlpsol.nlpsolver=<span class="string">'local_dn2fb'</span>;
inputs.nlpsol.cvodes_gradient=1;
inputs.nlpsol.iterprint=0;
AMIGO_Prep(inputs);
AMIGO_PE(inputs);
</pre><pre class="codeoutput">

*********************************** 
*     AMIGO, Copyright @CSIC      * 
*       AMIGO2_R1 [July 2013]        *
*********************************** 

*Date: 28-Sep-2015

------&gt;Pre processing....this may take a few seconds.


------&gt;Checking inputs....
------&gt; Generating C code ...
In file included from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_types.h:50:0, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_direct.h:26, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_direct.h:31, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_dense.h:24, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/AMIGO_model.h:6, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/amigoRHS.h:1, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:1: 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:65:0: warning: "SUNDIALS_BLAS_LAPACK" redefined [enabled by default] 
  #define SUNDIALS_BLAS_LAPACK 1 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:63:0: note: this is the location of the previous definition 
 #define SUNDIALS_BLAS_LAPACK 0 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:98:0: warning: "CL_m" redefined [enabled by default] 
 #define  CL_m (amigo_model-&gt;sim_results[0][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:12:0: note: this is the location of the previous definition 
 #define CL_m Ith(y,0) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:99:0: warning: "CL_c" redefined [enabled by default] 
 #define  CL_c (amigo_model-&gt;sim_results[1][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:13:0: note: this is the location of the previous definition 
 #define CL_c Ith(y,1) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:100:0: warning: "CL_n" redefined [enabled by default] 
 #define  CL_n (amigo_model-&gt;sim_results[2][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:14:0: note: this is the location of the previous definition 
 #define CL_n Ith(y,2) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:101:0: warning: "CT_m" redefined [enabled by default] 
 #define  CT_m (amigo_model-&gt;sim_results[3][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:15:0: note: this is the location of the previous definition 
 #define CT_m Ith(y,3) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:102:0: warning: "CT_c" redefined [enabled by default] 
 #define  CT_c (amigo_model-&gt;sim_results[4][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:16:0: note: this is the location of the previous definition 
 #define CT_c Ith(y,4) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:103:0: warning: "CT_n" redefined [enabled by default] 
 #define  CT_n (amigo_model-&gt;sim_results[5][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:17:0: note: this is the location of the previous definition 
 #define CT_n Ith(y,5) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:104:0: warning: "CP_n" redefined [enabled by default] 
 #define  CP_n (amigo_model-&gt;sim_results[6][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:18:0: note: this is the location of the previous definition 
 #define CP_n Ith(y,6) 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c: In function 'amigoRHS_get_OBS': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:146:2: warning: 'return' with a value, in function returning void [enabled by default] 
  return(amigo_model); 
  ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c: At top level: 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:150:0: warning: "CL_m" redefined [enabled by default] 
 #define  CL_m (amigo_model-&gt;sens_results[0][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:98:0: note: this is the location of the previous definition 
 #define  CL_m (amigo_model-&gt;sim_results[0][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:151:0: warning: "CL_c" redefined [enabled by default] 
 #define  CL_c (amigo_model-&gt;sens_results[1][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:99:0: note: this is the location of the previous definition 
 #define  CL_c (amigo_model-&gt;sim_results[1][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:152:0: warning: "CL_n" redefined [enabled by default] 
 #define  CL_n (amigo_model-&gt;sens_results[2][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:100:0: note: this is the location of the previous definition 
 #define  CL_n (amigo_model-&gt;sim_results[2][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:153:0: warning: "CT_m" redefined [enabled by default] 
 #define  CT_m (amigo_model-&gt;sens_results[3][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:101:0: note: this is the location of the previous definition 
 #define  CT_m (amigo_model-&gt;sim_results[3][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:154:0: warning: "CT_c" redefined [enabled by default] 
 #define  CT_c (amigo_model-&gt;sens_results[4][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:102:0: note: this is the location of the previous definition 
 #define  CT_c (amigo_model-&gt;sim_results[4][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:155:0: warning: "CT_n" redefined [enabled by default] 
 #define  CT_n (amigo_model-&gt;sens_results[5][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:103:0: note: this is the location of the previous definition 
 #define  CT_n (amigo_model-&gt;sim_results[5][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:156:0: warning: "CP_n" redefined [enabled by default] 
 #define  CP_n (amigo_model-&gt;sens_results[6][j][k])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:104:0: note: this is the location of the previous definition 
 #define  CP_n (amigo_model-&gt;sim_results[6][j])  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c: In function 'amigoRHS_get_sens_OBS': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:171:0: warning: "Lum" redefined [enabled by default] 
   #define  Lum   amigo_model-&gt;sens_obs[0][j][k]  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:130:0: note: this is the location of the previous definition 
   #define  Lum   amigo_model-&gt;obs_results[0][j]  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:172:0: warning: "mRNAa" redefined [enabled by default] 
   #define  mRNAa amigo_model-&gt;sens_obs[1][j][k]  
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Results\arabidopsis\amigoRHS.c:131:0: note: this is the location of the previous definition 
   #define  mRNAa amigo_model-&gt;obs_results[1][j]  
 ^ 
In file included from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_types.h:50:0, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_direct.h:26, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_direct.h:31, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/cvodes/cvodes_dense.h:24, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/AMIGO_model.h:6, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_amigo/amigoRHS.h:1, 
                 from D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c:2: 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:65:0: warning: "SUNDIALS_BLAS_LAPACK" redefined [enabled by default] 
  #define SUNDIALS_BLAS_LAPACK 1 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\include\include_cvodes/sundials/sundials_config.h:63:0: note: this is the location of the previous definition 
 #define SUNDIALS_BLAS_LAPACK 0 
 ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c: In function 'mexFunction': 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c:21:2: warning: passing argument 8 of 'run_mexFunction' from incompatible pointer type [enabled by default] 
  run_mexFunction(nlhs, plhs, nrhs,prhs, amigoRHS,amigoRHS_get_OBS,amigoRHS_get_sens_OBS,amigo_Y_at_tcon); 
  ^ 
D:\AMIGO2_REPO_2014\AMIGO_R2012_cvodes\Kernel\libAMIGO\src\src_mxInterface\amigo_mexFunction.c:6:16: note: expected 'void (*)(struct AMIGO_model,  realtype,  struct _generic_N_Vector *)' but argument is of type 'void (*)(void *, realtype,  struct _generic_N_Vector *)' 
  EXPORTIT void run_mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[],int(*rhs)(realtype,N_Vector, N_Vector, void*),void(obs_func)(void*),void(obs_sens_func)(void*),void(change_y_func)(AMIGO_model,realtype,N_Vector)); 
                ^ 


------&gt;Files generated....


*********************************** 
*     AMIGO, Copyright @CSIC      * 
*       AMIGO2_R1 [July 2013]        *
*********************************** 

*Date: 28-Sep-2015

------&gt;Checking inputs....

*************************************************************************


------&gt;IMPORTANT!!: Most of the optimization solvers have their own
                    tunning parameters (options).
                    Defaults have been assigned in the *NLPsolver*_options
                    files. You may need to modify those settings for your
                    particular problem, specially:
                      - maximum number of function evaluations /iterations,
                      - maximum computational time


******************************************************************

  Solving the NLP problem with

------&gt; Computing Correlation Matrix for unknowns...</pre><pre class="codeoutput">Index exceeds matrix dimensions.

Error in AMIGO_CramerRao (line 337)
                                sens{iexp}=privstruct.sens_t{iexp}(:,:,[1:nt_ltheta]);

Error in AMIGO_PE (line 277)
            [results,privstruct]=AMIGO_CramerRao(inputs,results,privstruct,1,inputs.exps.n_exp);

Error in doc_AMIGO_exe_type (line 263)
AMIGO_PE(inputs);
</pre><h2>Example fullC<a name="14"></a></h2><pre class="codeinput">inputs.model.input_model_type=<span class="string">'charmodelC'</span>;
inputs.model.exe_type=<span class="string">'fullC'</span>;
inputs.nlpsol.nlpsolver=<span class="string">'local_dn2fb'</span>;
inputs.nlpsol.cvodes_gradient=1;
[inputs privstruct]=AMIGO_Prep(inputs);
</pre><pre class="codeinput">AMIGO_htmldoc_inputs(inputs,fullfile(pwd,<span class="string">'html'</span>,<span class="string">'extypeex1.html'</span>));
</pre><p>The data will be necessary.</p><pre class="codeinput">save(<span class="string">'fullC_data'</span>,<span class="string">'inputs'</span>,<span class="string">'privstruct'</span>)
</pre><p>We return a gcc command you can use in the windows or linux command-line</p><pre class="codeinput">disp(inputs.model.comp_fullC);

res=regexp(inputs.model.comp_fullC,<span class="string">'\n*\n'</span>,<span class="string">'split'</span>);
system(res{3});


<span class="keyword">switch</span> computer

    <span class="keyword">case</span> {<span class="string">'PCWIN'</span>,<span class="string">'PCWIN64'</span>}

        system(<span class="string">'main fullC_data.mat save_fullC_data.mat sim_CVODES'</span>);

    <span class="keyword">otherwise</span>

        system(<span class="string">'./main fullC_data.mat save_fullC_data.mat sim_CVODES'</span>);
<span class="keyword">end</span>
</pre><p>The results are stored in save_fullC_data,mat</p><pre class="codeinput">clear;
load <span class="string">save_fullC_data</span>;
plot(outputs.simulation{1});
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.13<br></p></div><!--
##### SOURCE BEGIN #####


%% Execution modes in AMIGO

%% See also

    %%
    % * <doc_AMIGO_costMex.html costMex>
    % * <doc_AMIGO_fullMex.html fullMex>
    % * <doc_AMIGO_fullC.html fullC>
    % * <doc_AMIGO_Input.html how to input a problem in AMIGO>

%% Example

clear;
%============================
% RESULTS PATHS RELATED DATA
%============================
inputs.pathd.results_folder='arabidopsis';
inputs.pathd.short_name='arabidopsis';
inputs.pathd.run_overwrite='on';

% model definition:
inputs.model.n_st=7;
inputs.model.n_par=27;
inputs.model.n_stimulus=1;
inputs.model.st_names=char('CL_m','CL_c','CL_n','CT_m','CT_c','CT_n','CP_n');

inputs.model.par_names=char('n1','n2','g1','g2','m1','m2','m3','m4','m5','m6',...
    'm7','k1','k2','k3','k4','k5','k6','k7','p1','p2',...
    'p3','r1','r2','r3','r4','q1','q2');

inputs.model.stimulus_names=char('light');
inputs.model.eqns=...
    char('dCL_m=q1*CP_n*light+n1*CT_n/(g1+CT_n)-m1*CL_m/(k1+CL_m)',...
    'dCL_c=p1*CL_m-r1*CL_c+r2*CL_n-m2*CL_c/(k2+CL_c)',...
    'dCL_n=r1*CL_c-r2*CL_n-m3*CL_n/(k3+CL_n)',...
    'dCT_m=n2*g2^2/(g2^2+CL_n^2)-m4*CT_m/(k4+CT_m)',...
    'dCT_c=p2*CT_m-r3*CT_c+r4*CT_n-m5*CT_c/(k5+CT_c)',...
    'dCT_n=r3*CT_c-r4*CT_n-m6*CT_n/(k6+CT_n)',...
    'dCP_n=(1-light)*p3-m7*CP_n/(k7+CP_n)-q2*light*CP_n');

%%
% IMPORTANT:
%
% User may select any customised name but: n, t, u, y, ydot, par, tlast,
% told, pend and v which are reserved words

inputs.model.par=[7.5038 0.6801 1.4992 3.0412 10.0982...
    1.9685 3.7511 2.3422 7.2482 1.8981 1.2 3.8045...
    5.3087 4.1946 2.5356 1.4420 4.8600 1.2 2.1994...
    9.4440 0.5 0.2817 0.7676 0.4364 7.3021 4.5703 1.0];

inputs.exps.n_exp=2;

for iexp=1:inputs.exps.n_exp
    
    inputs.exps.exp_y0{iexp}=zeros(1,inputs.model.n_st);
    inputs.exps.t_f{iexp}=120;
    
    % OBSEVABLES DEFINITION
    inputs.exps.n_obs{iexp}=2;
    inputs.exps.obs_names{iexp}=char('Lum','mRNAa');
    inputs.exps.obs{iexp}=char('Lum=CL_m','mRNAa=CT_m');
    
end

inputs.exps.u_interp{1}='sustained';
inputs.exps.t_con{1}=[0 120];
inputs.exps.u{1}=1;

inputs.exps.u_interp{2}='pulse-down';
inputs.exps.n_pulses{2}=5;
inputs.exps.u_min{2}=0;inputs.exps.u_max{2}=1;
inputs.exps.t_con{2}=0:12:120;

%==================================
% EXPERIMENTAL DATA RELATED INFO
%==================================
inputs.exps.n_s{1}=15;
inputs.exps.n_s{2}=25;

inputs.exps.data_type='real';

inputs.exps.exp_data{1}=[
    0.037642  0.059832
    1.398618  0.983442
    1.606762  0.433379
    0.265345  0.628819
    1.417288  0.858973
    1.381613  0.496637
    0.504584  0.717923
    1.240249  0.862584
    1.180193  0.634508
    0.775945  0.679648
    1.514514  0.735783
    0.904653  0.593644
    0.753736  0.759013
    1.389312  0.678665
    0.833228  0.574736
    ];

inputs.exps.error_data{1}=[
    0.037642  0.059832
    0.072461  0.013999
    0.002877  0.020809
    0.050324  0.002705
    0.042936  0.017832
    0.044338  0.022538
    0.016335  0.017981
    0.164745  0.035301
    0.010631  0.102381
    0.127745  0.065791
    0.081671  0.049568
    0.126739  0.050306
    0.006308  0.018894
    0.054665  0.066953
    0.082163  0.015295
    ];

inputs.exps.exp_data{2}=[
    0.146016  0.018152
    0.831813  1.002499
    1.874870  0.816779
    1.927580  0.544111
    1.139536  0.354476
    0.876938  0.520424
    0.559600  0.802322
    1.273548  0.939453
    1.696482  0.687495
    1.065496  0.577896
    0.847460  0.524076
    0.517520  0.738095
    1.162232  0.826737
    1.421504  0.779833
    1.340639  0.550493
    0.563822  0.515605
    0.402755  0.714877
    1.029856  0.871118
    1.490741  0.840174
    1.580873  0.692047
    0.696610  0.459481
    0.141546  0.646803
    0.804194  0.925806
    1.622378  0.824711
    1.525194  0.537398
    ];

inputs.exps.error_data{2}=[
    0.146016  0.018152
    0.066547  0.045194
    0.184009  0.101495
    0.047431  0.030858
    0.175280  0.033712
    0.031945  0.048733
    0.107148  0.008715
    0.019847  0.072804
    0.111892  0.001840
    0.104932  0.058752
    0.059721  0.033324
    0.056537  0.000360
    0.051815  0.037473
    0.103393  0.028094
    0.008084  0.012024
    0.188444  0.022982
    0.046354  0.031981
    0.043436  0.003749
    0.030177  0.042560
    0.116245  0.110535
    0.059345  0.025112
    0.218587  0.000564
    0.115783  0.043708
    0.099239  0.002678
    0.010644  0.052990
    ];

inputs.PEsol.id_global_theta=char('n1','n2','m1','m4','m6','m7','k1','k4','p3');

inputs.PEsol.global_theta_guess=[...
    6.09794
    0.710144
    8.92735
    2.38504
    2.11024
    1.29912
    4.32079
    2.45277
    0.493076]';

inputs.PEsol.global_theta_max=10.*inputs.PEsol.global_theta_guess;
inputs.PEsol.global_theta_min=0.01.*inputs.PEsol.global_theta_guess;

inputs.PEsol.id_local_theta_y0{1}=char('CL_c','CP_n');
inputs.PEsol.local_theta_y0_max{1}=[1 1];
inputs.PEsol.local_theta_y0_min{1}=[0 0];
inputs.PEsol.local_theta_y0_guess{1}=[0.5 0.5];

inputs.PEsol.id_local_theta_y0{2}=char('CL_c','CP_n');
inputs.PEsol.local_theta_y0_max{2}=[1 1];
inputs.PEsol.local_theta_y0_min{2}=[0 0];
inputs.PEsol.local_theta_y0_guess{2}=[0.5 0.5];

%==================================
% COST FUNCTION RELATED DATA
%==================================

inputs.PEsol.PEcost_type='lsq';
inputs.PEsol.lsq_type='Q_I';

%==================================
% OPTIMIZATION SOLVER RELATED DATA
%==================================

    %%
    % More information regarding the inputs used in this example can be
    % found <extypeex1.html here>.




%% Example Standard

inputs.model.input_model_type='charmodelC';
inputs.model.exe_type='standard';
AMIGO_Prep(inputs);

%% Example costMex

inputs.model.input_model_type='charmodelC';
inputs.model.exe_type='costMex';
[inputs privstruct]=AMIGO_Prep(inputs);

    %%
    % You can use the mexfile to evaluate the objetive function value.

feval(inputs.model.mexfunction,'cost_LSQ');
fprintf(1,'Objective function value=%e\n',outputs.f);

    %%
    % The mexfile is located in:

disp(inputs.model.mexfile);

    %%
    % We can also compute the trajectories

feval(inputs.model.mexfunction,'sim_CVODES');

    %%
    % We can also compute sensitivities

feval(inputs.model.mexfunction,'sens_FSA_CVODES');


    %% Example fullMex

inputs.model.input_model_type='charmodelC';
inputs.model.exe_type='fullMex';
inputs.nlpsol.nlpsolver='local_dn2fb';
inputs.nlpsol.cvodes_gradient=1;
inputs.nlpsol.iterprint=0;
AMIGO_Prep(inputs);
AMIGO_PE(inputs);



    %% Example fullC

inputs.model.input_model_type='charmodelC';
inputs.model.exe_type='fullC';
inputs.nlpsol.nlpsolver='local_dn2fb';
inputs.nlpsol.cvodes_gradient=1;
[inputs privstruct]=AMIGO_Prep(inputs);

    %%
    %
    
AMIGO_htmldoc_inputs(inputs,fullfile(pwd,'html','extypeex1.html'));        


    %%
    % The data will be necessary.
    
save('fullC_data','inputs','privstruct')


    %%
    % We return a gcc command you can use in the windows or linux
    % command-line
   
disp(inputs.model.comp_fullC);

res=regexp(inputs.model.comp_fullC,'\n*\n','split');
system(res{3});


switch computer
    
    case {'PCWIN','PCWIN64'}
        
        system('main fullC_data.mat save_fullC_data.mat sim_CVODES');
        
    otherwise
        
        system('./main fullC_data.mat save_fullC_data.mat sim_CVODES');
end

    %%
    % The results are stored in save_fullC_data,mat
    


clear;
load save_fullC_data;
plot(outputs.simulation{1});


    %%
    %





##### SOURCE END #####
--></body></html>